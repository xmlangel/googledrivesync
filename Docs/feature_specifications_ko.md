# Google Drive Sync 기능 명세서 (Functional Specifications)

## 1. 프로젝트 개요

**Google Drive Sync**는 안드로이드 기기 내 로컬 폴더와 Google Drive 클라우드 폴더 간의 원활한 데이터 동기화를 제공하는 애플리케이션입니다. 사용자에게 익숙한 파일 탐색 경험과 함께 강력한 동기화 정책 설정을 통해 개인화된 백업 및 협업 환경을 구축하는 것을 목표로 합니다.

---

## 2. 사용 기능 (Usage Features)

사용자가 앱을 직접 조작하여 데이터를 관리하고 상태를 확인하는 핵심 기능입니다.

### 2.1 계정 및 인증 관리

* **Google 로그인/로그아웃**: Google Drive API 접근을 위한 OAuth 2.0 기반 인증을 지원합니다.
* **다중 계정 지원**: 여러 개의 Google 계정을 등록하고, 필요에 따라 활성 계정을 전환할 수 있습니다.
* **연결 상태 확인**: 현재 연결된 계정의 이메일 주소 및 상태를 실시간으로 대시보드에서 확인할 수 있습니다.

### 2.2 동기화 페어(Pair) 구성

* **드라이브 탐색**: Google Drive 내의 폴더 구조를 트리 형태로 탐색하여 동기화할 대상 폴더를 선택합니다.
* **로컬 폴더 선택**: 기기 저장소(내부 저장소) 내에서 동기화할 폴더를 지정합니다.
* **페이링 등록**: 선택한 로컬 폴더와 드라이브 폴더를 하나의 '동기화 쌍'으로 묶어 등록합니다.

### 2.3 대시보드 및 실시간 모니터링

* **목록 조회**: 현재 등록된 모든 동기화 페어의 목록과 마지막 동기화 시점을 확인합니다.
* **상태 인디케이터**: 동기화 중(파일 이름, 진행률 %), 대기 중, 오류 발생 등의 상태를 시각적으로 표시합니다.
* **진행률 세부 정보**: 현재 처리 중인 파일명, 전체 파일 대비 현재 인덱스, 전송된 바이트 숫자를 실시간으로 보여줍니다.

### 2.4 수동 제어

* **즉시 실행**: 스케줄과 별개로 사용자가 원할 때 `동기화 시작` 버튼을 눌러 작업을 즉시 수행합니다.
* **작업 취소**: 진행 중인 동기화 프로세스를 안전하게 중단합니다.

### 2.5 동기화 이력(History) 관리

* **로그 상세 조회**: 과거에 수행된 동기화 작업의 성공 여부, 시작/종료 시간, 업로드/다운로드 파일 개수, 에러 발생 횟수를 기록합니다.
* **에러 추적**: 동기화 실패 시 어떤 파일에서 문제가 발생했는지 상세 메시지를 제공합니다.

---

## 3. 설정 기능 (Setting Features)

앱의 동작 방식과 자동화 규칙을 개인화하기 위한 세부 설정 기능입니다.

### 3.1 동기화 정책 설정 (Sync Direction)

각 동기화 페어별로 데이터 흐름을 정의합니다.

* **양방향 동기화 (Bidirectional)**: 양쪽의 변경 사항을 모두 비교하여 최신 상태로 유지합니다.
* **업로드 전용 (Upload Only)**: 로컬의 변경 사항만 드라이브에 반영합니다.
* **다운로드 전용 (Download Only)**: 드라이브의 변경 사항만 로컬에 반영합니다.

### 3.2 자동화 스케줄링

* **자동 동기화 스위치**: 백그라운드 자동 동기화 기능을 전체적으로 켜거나 끌 수 있습니다.
* **동기화 주기 설정**: 15분, 30분, 1시간, 6시간 등 일정 간격으로 동기화가 자동 실행되도록 스케줄을 설정합니다. (Android OS의 제약에 따라 최소 15분 이상 권장)

### 3.3 실행 조건 제약 (Constraints)

배터리 및 데이터 소모를 최적화하기 위한 제약 사항을 설정합니다.

* **Wi-Fi 전용 모드**: Wi-Fi에 연결된 상태에서만 동기화를 수행하여 모바일 데이터를 보호합니다.
* **충전 중 전용 모드**: 기기가 전원에 연결된 상태에서만 동기화를 수행하여 배터리 소모를 방지합니다.

### 3.4 알림(Notification) 제어

* **완료 알림**: 동기화 작업이 성공적으로 끝났을 때 푸시 알림을 받을지 여부를 설정합니다.
* **오류 알림**: 동기화 중 문제가 발생하거나 사용자 개입이 필요한 충돌 상황 시 알림을 받습니다.

### 3.5 충돌 해결 전략 (Conflict Resolution)

로컬과 원격의 동일 파일이 동시에 수정되었을 때의 처리 방식을 사전 정의합니다.

* **항상 묻기 (Always Ask)**: 사용자가 대시보드나 알림을 통해 직접 해결 방법을 선택합니다.
* **로컬 우선 (Use Local)**: 로컬 파일의 내용을 덮어씁니다.
* **드라이브 우선 (Use Drive)**: 클라우드의 파일 내용으로 로컬을 업데이트합니다.
* **모두 유지 (Keep Both)**: 충돌 파일의 이름을 변경하여 두 버전을 모두 보관합니다.
* **건너뛰기 (Skip)**: 해당 파일의 동기화를 무시하고 다음 파일로 진행합니다.

---

## 4. 기술 사양 요약

| 항목 | 내용 |
| :--- | :--- |
| **데이터베이스** | Room DB (설정, 상태, 이력 저장) |
| **백그라운드 작업** | WorkManager (스케줄 및 제약 조건 관리) |
| **변경 감지 방식** | 파일 수정 시간(Timestamp) 및 크기(Size) 비교 |
| **인증 방식** | Google OAuth 2.0 (Drive API 권한) |

---

## 5. 주요 기능 요약

| 분류 | 기능명 | 주요 내용 | 상세 설명 |
| :--- | :--- | :--- | :--- |
| **사용 기능** | 계정 관리 | Google 계정 인증 및 다중 계정 전환 | OAuth 2.0 기반 안전한 로그인 지원 및 활성 계정의 실시간 전환 기능 제공 |
| | 동기화 페어 구성 | 로컬/드라이브 폴더 쌍(Pair) 등록 및 관리 | 로컬 저장소와 구글 드라이브 내 특정 폴더를 매핑하여 개별적인 동기화 규칙 적용 |
| | 모니터링 | 실시간 동기화 상태 및 진행률 표시 | 현재 처리 중인 파일명, 전체 진행률(%), 전송 바이트 등을 대시보드에서 실시간 확인 |
| | 이력 관리 | 과거 동기화 성공/실패 기록 및 상세 로그 조회 | 모든 동기화 작업의 시작/종료 시간, 처리된 파일 수, 발생한 에러 상세 로그 제공 |
| **설정 기능** | 동기화 정책 | 양방향, 업로드 전용, 다운로드 전용 선택 | 사용자의 목적에 따라 파일의 이동 방향(Bidirectional, Local to Drive, Drive to Local)을 결정 |
| | 자동화 설정 | 동기화 주기(최소 15분) 및 자동 실행 스케줄링 | WorkManager를 통해 주기적인 백그라운드 동기화를 수행하며 배터리 최적화 고려 |
| | 실행 제약 | Wi-Fi 연결 시, 충전 시에만 작동하도록 제한 | 모바일 데이터 소모 방지 및 배터리 보호를 위한 특정 환경 조건 하에서의 실행 제어 |
| | 충돌 해결 | 로컬/드라이브 우선순위 및 파일 이름 변경 보관 정책 | 동일 파일 동시 수정 시 덮어쓰기, 건너뛰기, 또는 '_(local)' 접미사를 통한 양쪽 유지 처리 |
